# cpp-util
utility scripts that make sure of the clang library to help understand C++ source code<br>

## class_graph.py
use libclang to parse C++ source code for class inheritance hierarchy

### dependencies
```
sudo apt-get install clang libclang-dev graphviz
# assuming libclang is version 14, to check version: apt show libclang-dev
pip install clang==14
# pip install clang==10.0.1 # for libclang version 10 users
pip install graphviz
```

### usage
This step is not strictly required but recommended.<br>
Generate a compile database JSON following clang's specification<br>
Checkout the `Bear` project https://github.com/rizsotto/Bear, the JSON file then can be generated by 
```
# Makefile users
bear -- make
```
Then run the script at the root path of the project
```
python3 class_graph.py
```
By default, a graph report will be generated. The report is stored at ./class_graph as Graphviz's DOT text and ./class_graph.pdf as an image<br>
The Graphviz text can be viewed using online tools like https://dreampuf.github.io/GraphvizOnline/<br>
<br>
Because parsing the source code is time consuming, a JSON file will be used to store the parsing result. When the script is run afterward, it will re-use the result stored in the JSON file. If the source code has been changed, `--rebuild` option needs to be used to force re-parse the source code.

### options
`class_graph.py -h`
```
  --rebuild             regenerate the JSON database, use when source code is modify

  --compile_db compile_commands.json
                        JSON Compilation Database in Clang Format, will attempt to use ./compile_commands.json when not provided
  --path PATH           path to workspace root, defult is current directory

  --tree                output in tree view instead of graph view
  -b, --base            only print the ancestor classes
  -d, --derived         only print the descendant classes
  -r, --related         print both the ancestor and descendant classes, this is the default
  -c, --connected, --all
                        print all classes that are connected to any of the ancestor and descendant classes, only available in graph report
```
